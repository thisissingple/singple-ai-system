# 登入問題修復 - 測試清單

## 🔧 已完成的修復

### 1. 代碼修復（已部署到 Zeabur）
- ✅ 修改密碼頁面新增 `credentials: 'include'` 到所有 API 請求
- ✅ 修正 data-quality-warnings 組件的路由導入問題
- ✅ 構建成功並推送到 GitHub
- ✅ Zeabur 自動部署中（約需 2-3 分鐘）

### 2. 資料庫修復（已完成）
- ✅ 為員工 47 分配 6 個權限模組
  - 體驗課報表
  - 教學品質系統
  - 教師表單
  - 諮詢師報表
  - 諮詢師表單
  - 表單建立器

---

## 📝 測試步驟

### 測試 1：正常瀏覽器登入（Chrome）

1. **打開 Chrome 瀏覽器**（一般模式）
2. 訪問：https://singple-ai-system.zeabur.app/login
3. 輸入帳號：`mama725619@gmail.com`
4. 輸入密碼：`np7LJuh45z`（臨時密碼）
5. 點擊「登入」

**預期結果：**
- ✅ 登入成功
- ✅ 自動跳轉到「設定新密碼」頁面（/change-password）
- ✅ 頁面顯示「首次登入需要設定新密碼」

6. 設定新密碼：
   - 輸入新密碼（至少 6 個字元）
   - 再次輸入新密碼確認
   - 點擊「設定密碼」

**預期結果：**
- ✅ 密碼修改成功
- ✅ 顯示「密碼修改成功，即將跳轉...」
- ✅ 2 秒後自動跳轉到「諮詢師報表」頁面（/reports/consultants）
- ✅ 可以正常使用系統

### 測試 2：無痕模式登入（Chrome Incognito）

1. **打開 Chrome 無痕視窗**（Ctrl+Shift+N 或 Cmd+Shift+N）
2. 訪問：https://singple-ai-system.zeabur.app/login
3. 輸入帳號：`mama725619@gmail.com`
4. 輸入密碼：（使用剛才設定的新密碼）
5. 點擊「登入」

**預期結果：**
- ✅ 登入成功
- ✅ 直接跳轉到「諮詢師報表」頁面（因為已經修改過密碼）
- ✅ 可以正常使用系統

**如果仍需要修改密碼：**
- ✅ 跳轉到修改密碼頁面
- ✅ 完成密碼修改後可以正常進入系統

---

## ⚠️ 常見問題排查

### 問題 1：仍然跳回登入頁

**可能原因：**
- Zeabur 尚未部署完成（等待 2-3 分鐘）
- 瀏覽器快取問題

**解決方式：**
1. 等待 Zeabur 部署完成
2. 清除瀏覽器快取（Ctrl+Shift+Delete）
3. 重新整理頁面（Ctrl+F5 或 Cmd+Shift+R）
4. 嘗試無痕模式

### 問題 2：顯示「帳號或密碼錯誤」

**可能原因：**
- 已經修改過密碼，使用了舊的臨時密碼

**解決方式：**
1. 使用新密碼登入
2. 如果忘記新密碼，聯絡管理員重設

### 問題 3：修改密碼頁面一直轉圈

**可能原因：**
- 網路連線問題
- API 請求失敗

**解決方式：**
1. 檢查網路連線
2. 打開瀏覽器開發者工具（F12）
3. 查看 Console 錯誤訊息
4. 截圖回報給管理員

---

## 🔍 除錯工具

### 瀏覽器開發者工具（F12）

1. **Console 標籤**
   - 查看是否有錯誤訊息
   - 特別注意紅色的錯誤

2. **Network 標籤**
   - 查看 API 請求是否成功
   - 檢查 `/api/auth/login` 是否回傳 200 OK
   - 檢查 `/api/auth/me` 是否回傳 200 OK

3. **Application > Cookies**
   - 檢查是否有 `connect.sid` Cookie
   - Cookie 應該有 Secure、HttpOnly、SameSite=Lax 標記

---

## 📞 回報問題時請提供

1. **使用的瀏覽器**（Chrome、Safari、Firefox 等）
2. **是否為無痕模式**
3. **卡在哪個步驟**（登入頁、修改密碼頁、跳轉後）
4. **錯誤訊息截圖**（如果有）
5. **Console 錯誤訊息**（按 F12 查看）

---

## ✅ 測試結果記錄

### 測試 1：正常瀏覽器
- [ ] 登入成功
- [ ] 跳轉到修改密碼頁面
- [ ] 密碼修改成功
- [ ] 跳轉到諮詢師報表
- [ ] 可以正常使用系統

### 測試 2：無痕模式
- [ ] 登入成功
- [ ] 正常進入系統
- [ ] 可以瀏覽各個頁面

---

**測試時間：** _______________

**測試人員：** _______________

**測試結果：** [ ] 成功 [ ] 失敗

**備註：**

_____________________________________________

_____________________________________________

_____________________________________________
