# 🔗 系統整合規劃

> **建立日期**: 2025-10-09
> **狀態**: 規劃階段
> **優先順序**: 中期（表單記錄管理完成後）

---

## 🎯 整合目標

### 1. Go High Level 整合（學員資料）

**目的**: 讓體驗課表單的學員姓名/Email 可以直接選擇，不用手動輸入

#### 當前狀況
- ✅ 學員姓名、Email 採用開放輸入（防止打字錯誤）
- ❌ 無法從 Go High Level 自動同步學員名單
- ❌ 需要手動輸入，增加錯誤風險

#### 整合方案

**方案 A：即時 API 整合**（推薦）
```
表單載入 → 呼叫 GHL API → 取得學員名單 → 下拉選單
```

**優點**：
- 資料即時同步
- 不需要維護本地學員資料庫
- 新學員立即可用

**缺點**：
- 依賴 GHL API 可用性
- 每次表單載入都會呼叫 API

**技術需求**：
1. Go High Level API Key
2. 學員資料存放位置（Contacts / Opportunities）
3. API 端點：`GET /api/ghl/contacts`
4. 前端：Combobox 組件（可搜尋的下拉選單）

---

**方案 B：定期同步**（次選）
```
每日凌晨 → 從 GHL 同步 → 存入 Supabase students 表 → 表單讀取
```

**優點**：
- 表單載入快速
- 減少 API 呼叫次數
- 可離線使用

**缺點**：
- 新學員有延遲（最多 24 小時）
- 需要維護同步機制

**技術需求**：
1. Go High Level API Key
2. Supabase `students` 資料表
3. 定時任務（Cron Job）
4. 同步腳本

---

#### 實作步驟

**Phase 1: API 串接準備**
1. 取得 Go High Level API Key
2. 測試 API 存取權限
3. 確認學員資料結構

**Phase 2: 後端開發**
1. 建立 `/api/ghl/contacts` 端點
2. 實作 GHL API 呼叫
3. 資料轉換與快取

**Phase 3: 前端整合**
1. 安裝 Combobox 組件（shadcn/ui）
2. 整合學員搜尋功能
3. 自動填入 Email（選擇姓名後自動帶入）

**Phase 4: 測試與優化**
1. 測試 API 效能
2. 加入錯誤處理
3. 優化使用者體驗

**預估時間**: 4-6 小時

---

### 2. Zoom 文字轉檔自動抓取

**目的**: 自動取得 Zoom 課程文字檔，不需要老師手動複製貼上

#### 當前狀況
- ✅ 老師在 Zoom 開啟文字轉檔
- ❌ 需要手動複製貼上到表單
- ❌ 容易忘記或遺失

#### 整合方案

**方案 A：Zoom 雲端錄影整合**（推薦）
```
課程結束 → Zoom 自動上傳 → Webhook 通知 → 下載文字檔 → 存入 Supabase
```

**優點**：
- 完全自動化
- 不需要老師操作
- 文字檔永久保存

**缺點**：
- 需要 Zoom Pro 或以上方案
- 需要設定 Webhook

**技術需求**：
1. Zoom Pro 帳號
2. 啟用雲端錄影功能
3. 設定 Webhook 接收通知
4. 下載並解析文字檔（VTT/SRT 格式）

**實作步驟**：
1. 在 Zoom 後台設定 Webhook URL（`https://your-domain.com/api/zoom/webhook`）
2. 課程結束後，Zoom 會發送通知到你的伺服器
3. 伺服器下載文字檔並存入 Supabase
4. 在體驗課記錄中顯示「已自動抓取文字檔 ✅」

---

**方案 B：Zoom Meeting API**（次選）
```
老師選擇會議 → API 抓取文字檔 → 自動填入表單
```

**優點**：
- 老師可以選擇特定會議
- 不需要 Webhook

**缺點**：
- 仍需要老師手動觸發
- 需要記住 Meeting ID

**技術需求**：
1. Zoom API Key
2. 列出最近會議
3. 下載文字檔 API

---

**方案 C：本地文字檔上傳**（最簡單）
```
老師下載文字檔 → 上傳到表單 → 自動填入
```

**優點**：
- 實作簡單（1 小時內完成）
- 不需要 Zoom API

**缺點**：
- 仍需要老師手動操作
- 多一個步驟

**技術需求**：
1. 檔案上傳組件
2. 解析 VTT/SRT 格式
3. 顯示在表單中

---

#### 推薦方案

**立即可做**：方案 C（檔案上傳）
- 今天就能實作完成
- 老師只需要拖拉上傳，比複製貼上快

**中期目標**：方案 A（Zoom Webhook）
- 完全自動化
- 最佳使用者體驗

---

### 3. AI 分析與建議

**目的**: 分析課程文字檔，提供評分與下堂課建議

#### 技術架構

```
課程文字檔 → Claude API → 分析報告 → 存入 Supabase → 顯示在報表
```

#### AI 分析項目

1. **課程品質評分**（1-10 分）
   - 老師授課流暢度
   - 學生參與程度
   - 教學內容豐富度

2. **學生表現分析**
   - 回答問題次數
   - 主動發言次數
   - 學習積極度

3. **下堂課建議**
   - 需要加強的重點
   - 推薦的教學方法
   - 練習曲目建議

4. **轉單機會評估**
   - 學生滿意度（高/中/低）
   - 轉單可能性（%）
   - 建議跟進方式

#### 實作步驟

1. 建立 AI 分析 API 端點
2. 設計 Prompt 模板
3. 呼叫 Claude API
4. 解析 AI 回應並儲存
5. 在報表中顯示分析結果

**預估時間**: 6-8 小時

---

## 📅 整合時程規劃

### 立即可做（本週）
1. ✅ 老師下拉選單（已完成）
2. 🔲 Zoom 文字檔上傳功能（方案 C）

### 短期目標（2 週內）
1. 🔲 Go High Level API 整合（學員名單）
2. 🔲 AI 課程分析基礎版

### 中期目標（1 個月內）
1. 🔲 Zoom Webhook 自動抓取
2. 🔲 AI 分析進階功能（轉單評估）

### 長期目標（3 個月內）
1. 🔲 完整自動化流程
2. 🔲 AI 個人化教學建議

---

## ✅ 待辦事項提醒

### Go High Level 整合
- [ ] 取得 API Key
- [ ] 測試 API 存取
- [ ] 確認學員資料結構
- [ ] 建立整合端點

### Zoom 整合
- [ ] 確認 Zoom 方案（Pro/Business）
- [ ] 測試文字檔格式
- [ ] 選擇整合方案（A/B/C）
- [ ] 實作整合功能

### AI 分析
- [ ] 設計分析項目
- [ ] 撰寫 Prompt 模板
- [ ] 測試 Claude API
- [ ] 建立分析報表頁面

---

## 💡 注意事項

1. **Go High Level**
   - 需要確認 API 呼叫次數限制
   - 建議使用快取減少 API 呼叫

2. **Zoom**
   - 雲端錄影會佔用儲存空間
   - 需要定期清理舊檔案

3. **AI 分析**
   - Claude API 有使用成本
   - 建議只分析重要課程

---

## 📞 需要提供的資訊

當你準備開始整合時，請提供：

### Go High Level
- [ ] API Key
- [ ] 學員資料存放位置（URL）
- [ ] 學員總數（估計）

### Zoom
- [ ] 帳號方案（Basic/Pro/Business）
- [ ] 是否啟用雲端錄影
- [ ] 是否可以設定 Webhook

### AI 分析
- [ ] 希望分析哪些項目
- [ ] 分析頻率（每堂課/每週/手動）
- [ ] 預算考量

---

**下一步**: 完成表單記錄管理功能後，再開始整合工作。
