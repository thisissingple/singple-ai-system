# 收支記錄表 - 詳細資訊簡化更新

**日期**: 2025-10-16
**狀態**: ✅ 完成

---

## 🎯 簡化目標

1. **移除課程編號欄位** - 不需要
2. **移除課程類型欄位** - 不需要  
3. **整合時間欄位** - 建立時間和最後更新合併為一個

---

## ✅ 完成的修改

### 1. 移除課程相關欄位

**移除前** (業務資訊 3 欄)：
```
💼 付款方式  📚 課程編號  🎓 課程類型
```

**移除後** (業務資訊 1 欄)：
```
💼 付款方式
```

### 2. 整合時間欄位

**整合前** (時間資訊 2 欄)：
```
🕐 建立時間：2025/10/16 下午04:17
🕑 最後更新：2025/10/16 下午04:17
```

**整合後** (時間資訊 1 欄)：
```
🕑 最後更新：2025/10/16 下午04:17
    (如果無更新或時間相同，則顯示建立時間)
```

**顯示邏輯**：
```typescript
// 如果有更新且時間不同，顯示「最後更新」
{row.updated_at && row.updated_at !== row.created_at ? '🕑 最後更新：' : '🕐 建立時間：'}

// 對應顯示更新時間或建立時間
{formatDateTime(row.updated_at && row.updated_at !== row.created_at ? row.updated_at : row.created_at)}
```

---

## 📋 最終詳細資訊佈局

```
┌────────────── 詳細資訊 ──────────────┐
│                                       │
│  業務資訊 (1 欄)                      │
│  [付款方式]                           │
│                                       │
│  人員資訊 (3 欄)                      │
│  [電訪人員▼]  [諮詢人員▼]  [填表人▼] │
│                                       │
│  ──────────────────────────────────── │
│  🕑 最後更新：2025/10/16 下午04:17   │
│                                       │
│  💱 使用匯率：1 USD = 30.58 TWD      │
└───────────────────────────────────────┘
```

---

## 🔄 儲存邏輯更新

**移除的欄位**：
```typescript
// ❌ 已移除
course_code: row.course_code?.trim() || null,
course_type: row.course_type || null,
```

**保留的欄位**：
```typescript
payment_method: row.payment_method?.trim() || null,
sales_person_id: row.sales_person_id || null,
consultant_id: row.consultant_id || null,
created_by: row.created_by || null,
```

---

## 📂 修改的檔案

**前端**：
- `client/src/pages/reports/income-expense-manager.tsx`
  - 業務資訊從 3 欄改為 1 欄
  - 移除課程編號和課程類型輸入框
  - 時間資訊從 2 欄改為 1 欄
  - 智能顯示建立/更新時間
  - 儲存 payload 移除課程相關欄位

---

## 🎯 簡化效果

| 項目 | 簡化前 | 簡化後 | 效益 |
|------|--------|--------|------|
| 業務資訊欄位 | 3 個 | 1 個 | 減少 2 個不必要欄位 |
| 時間資訊欄位 | 2 個 | 1 個 | 避免資訊重複 |
| 詳細資訊總欄位 | 6 個 | 5 個 | 介面更簡潔 |
| 展開區域高度 | ~200px | ~150px | 減少視覺負擔 |

---

## 💡 設計理由

### **為什麼移除課程編號和類型？**
1. **低使用率**：實際業務中較少使用
2. **可用備註替代**：有需要時在備註欄填寫即可
3. **簡化流程**：減少填寫負擔，提高效率

### **為什麼整合時間欄位？**
1. **資訊重複**：剛建立的記錄兩個時間相同
2. **智能顯示**：有更新才顯示更新時間
3. **節省空間**：讓介面更簡潔

---

**完成時間**: 2025-10-16 下午
**修改行數**: ~30 行
**測試狀態**: ⏳ 待瀏覽器驗證
